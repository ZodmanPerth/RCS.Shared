<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
>
	<!--
		Copied for reference from PresentationFremework.Aero2.dll using ILSpy
		Renamed keys for human readability
	-->
	
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Geometry.Stroke" Color="#FF818181" />
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Geometry.Background" Color="#FFFFFFFF" />
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Hover.Stroke" Color="#FF27C7F7" />
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Hover.Background" Color="#FFCCEEFB" />
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Checked.Stroke" Color="#FF262626" />
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Checked.Background" Color="#FF595959" />
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Hover.Checked.Stroke" Color="#FF1CC4F7" />
	<SolidColorBrush x:Key="Core.Brush.TreeViewItem.ToggleButton.Hover.Checked.Background" Color="#FF82DFFB" />

	<PathGeometry x:Key="Core.Brush.TreeViewItem.ToggleButton.Geometry">
		<PathGeometry.Figures>
			<PathFigureCollection>
				<PathFigure IsFilled="True" StartPoint="0 0" IsClosed="True">
					<PathFigure.Segments>
						<PathSegmentCollection>
							<LineSegment Point="0 6" />
							<LineSegment Point="6 0" />
						</PathSegmentCollection>
					</PathFigure.Segments>
				</PathFigure>
			</PathFigureCollection>
		</PathGeometry.Figures>
	</PathGeometry>

	<Style x:Key="Core.Style.TreeViewItem.ToggleButton" TargetType="{x:Type ToggleButton}">
		<Setter Property="Focusable" Value="False" />
		<Setter Property="Width" Value="16" />
		<Setter Property="Height" Value="16" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type ToggleButton}">

					<Border
						Width="16"
						Height="16"
						Background="#00FFFFFF"
						Padding="5,5,5,5"
					>
						<Path
							Name="ExpandPath"
							Fill="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Geometry.Background}"
							Stroke="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Geometry.Stroke}"
							Data="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Geometry}"
						>
							<UIElement.RenderTransform>
								<RotateTransform Angle="135" CenterX="3" CenterY="3" />
							</UIElement.RenderTransform>
						</Path>
					</Border>

					<ControlTemplate.Triggers>
						<Trigger Property="ToggleButton.IsChecked" Value="True">
							<Setter TargetName="ExpandPath" Property="RenderTransform">
								<Setter.Value>
									<RotateTransform Angle="180" CenterX="3" CenterY="3" />
								</Setter.Value>
							</Setter>
							<Setter TargetName="ExpandPath" Property="Shape.Fill" Value="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Checked.Background}" />
							<Setter TargetName="ExpandPath" Property="Shape.Stroke" Value="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Checked.Stroke}" />
						</Trigger>
						<Trigger Property="UIElement.IsMouseOver" Value="True">
							<Setter TargetName="ExpandPath" Property="Shape.Stroke" Value="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Hover.Stroke}" />
							<Setter TargetName="ExpandPath" Property="Shape.Fill" Value="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Hover.Background}" />
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="UIElement.IsMouseOver" Value="True" />
								<Condition Property="ToggleButton.IsChecked" Value="True" />
							</MultiTrigger.Conditions>
							<Setter TargetName="ExpandPath" Property="Shape.Stroke" Value="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Hover.Checked.Stroke}" />
							<Setter TargetName="ExpandPath" Property="Shape.Fill" Value="{StaticResource Core.Brush.TreeViewItem.ToggleButton.Hover.Checked.Background}" />
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="Core.Style.TreeViewItem.FocusVisual">
		<Setter Property="Control.Template">
			<Setter.Value>
				<ControlTemplate>
					<Rectangle />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="Core.Style.TreeViewItem" TargetType="{x:Type TreeViewItem}">
		<Setter Property="Background" Value="#00FFFFFF" />
		<Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
		<Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
		<Setter Property="Padding" Value="1,0,0,0" />
		<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
		<Setter Property="FrameworkElement.FocusVisualStyle" Value="{DynamicResource Core.Style.TreeViewItem.FocusVisual}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type TreeViewItem}">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition MinWidth="19" Width="Auto" />
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="*" />
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto" />
							<RowDefinition />
						</Grid.RowDefinitions>

						<ToggleButton
							Name="Expander"
							ClickMode="Press"
							Style="{DynamicResource Core.Style.TreeViewItem.ToggleButton}"
							IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
						/>

						<Border
							Name="Bd"
							Grid.Column="1"
							Background="{TemplateBinding Control.Background}"
							BorderBrush="{TemplateBinding Control.BorderBrush}"
							BorderThickness="{TemplateBinding Control.BorderThickness}"
							Padding="{TemplateBinding Control.Padding}"
							SnapsToDevicePixels="True"
						>
							<ContentPresenter
								Name="PART_Header"
								ContentSource="Header"
								HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}"
								SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}"
							/>
						</Border>

						<ItemsPresenter
							Name="ItemsHost"
							Grid.Row="1"
							Grid.Column="1"
							Grid.ColumnSpan="2"
						/>

					</Grid>

					<ControlTemplate.Triggers>

						<Trigger Property="TreeViewItem.IsExpanded" Value="False">
							<Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed" />
						</Trigger>

						<Trigger Property="ItemsControl.HasItems" Value="False">
							<Setter TargetName="Expander" Property="Visibility" Value="Hidden" />
						</Trigger>

						<Trigger Property="TreeViewItem.IsSelected" Value="True">
							<Setter TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" Property="Border.Background" />
							<Setter Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" Property="Foreground" />
						</Trigger>

						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="TreeViewItem.IsSelected" Value="True" />
								<Condition Property="TreeViewItem.IsSelectionActive" Value="False" />
							</MultiTrigger.Conditions>
							<Setter TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}" Property="Border.Background" />
							<Setter Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}}" Property="Foreground" />
						</MultiTrigger>

						<Trigger Property="IsEnabled" Value="False">
							<Setter Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" Property="Foreground" />
						</Trigger>

					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>

		</Setter>

		<Style.Triggers>
			<Trigger Property="VirtualizingPanel.IsVirtualizing" Value="True">
				<Setter Property="ItemsPanel">
					<Setter.Value>
						<ItemsPanelTemplate>
							<VirtualizingStackPanel />
						</ItemsPanelTemplate>
					</Setter.Value>
				</Setter>
			</Trigger>
		</Style.Triggers>

	</Style>
	
</ResourceDictionary>
